# UTXO-backup-service

A service that allows you to recover your btc via a signed timelocked transaction

## Introduction

The bitcoin scripting language allows you to create transactions that only become valid once a certain timestamp has been reached. This allows us to create transactions with a future date for the purposes of backing up our coins. This repo provides the code for a simple service that allows you to sign a transaction with a future date that hands the funds over to us in the event that you lose access to your keys. This service is completely trustless in the sense that we never hold your private keys, the timelock transaction can be revoked at any time by spending the UTXOs and the transactions that are signed can be stored anywhere, without the risk of an attacker spending the funds (as they are locked by time and will only go to a predetermined recipient).

You can read more about this method [here](https://medium.com/@james-sangalli/utxo-based-backups-an-idea-for-bitcoin-cold-storage-21f620c35981).

## Architecture

### Timelocked transaction signing

The user signs a timelocked transaction with a specific timestamp. This transaction should include all cold storage inputs and have a date sufficiently far into the future. This transaction's recipient is designated to an address generated by us. The address generated by us will come from our cold storage master key. Each user will get a fresh address derived from this master key and the database will keep track of the counter for the derived addresses.

The raw bytes for this transaction are sent to our server and the user is free to keep a copy on their own devices.

### Process and alerts

Once the transaction is saved on the server side, our server will create an alert to remind both us and the user once the deadline for the timelock looms closer.

30 days (or some other time period) before the transaction is set to become valid, the server will send a reminder to the user telling them that they need to either invalidate the transaction by spending the inputs (which validates that they still own the keys) or allow the time to lapse. If the time elapses without a response, we broadcast the transaction and take custody of the funds. We can then contact the user to create a new wallet for us to send the funds to.

If the user still has full custody of the coins, they can invalidate the timelocked transaction by spending the inputs and repeating the process again, creating a new timelocked transaction with a future date.

If at any point the user spends the UTXOs that have been timelocked, they will receive an alert from our server informing them that they are no longer covered and will need to repeat the process.

## Limitations

### Spending UTXOs will invalidate the process

If the user spends any of the UTXOs contained within the timelocked transaction, they must repeat the process. Our server can alert them but this means that this service is really only for those that have cold storage that rarely moves.

## Other potential features

### Continuous transactions

We could adapt the process such that the user signs multiple timelocked transactions, one to us and another to another cold storage address in their control (this could even be the same address or one derived from the same seed). They could then sign future potential transactions with the subsequent key and repeat the process many times.

When the transaction timelock is reached, they can alert us that they still have custody of the funds and automatically broadcast the transaction, sending the funds to their next address, invalidating the old timelocked transaction and making the next set of transactions valid. Since future UTXOs can be deterministically created, we can sign transactions from keys that do not yet have the UTXOs but will when a certain transaction is broadcasted and the UTXOs become spendable on the new key.
